---
version: "3.7"
networks:
  t2_proxy:
    external: true
services:
  calibre:
#calibre: The one stop solution for all your e-book needs. Comprehensive e-book software.
    image: lscr.io/linuxserver/calibre
    container_name: calibre
    environment:
      - PUID=0
      - PGID=0
      - TZ=Europe/London
#      - PASSWORD= #optional
#      - CLI_ARGS= #optional
    volumes:
      - /path/to/data:/config
      - /mnt/ebooks:/ebooks
    ports:
      - 8080:8080
      - 8081:8081
    restart: unless-stopped
    labels:
      - traefik.enable=true
      - traefik.http.services.calibre-https.loadbalancer.server.port=8081
      - traefik.http.routers.calibre-https.entrypoints=https
      - traefik.http.routers.calibre-https.rule=Host(`${CALIBRE_SUB?CALIBRE_SUB Variable not set}.${DOMAIN?DOMAIN Variable not set}`)
      - traefik.http.routers.calibre-https.tls=true
      - traefik.http.routers.calibre-https.tls.certresolver=myresolver
      - traefik.http.routers.calibre-https.middlewares=authelia@docker
    networks:
      - t2_proxy
  calibre-web:
#Calibre-Web is a web app providing a clean interface for browsing, reading and downloading eBooks using an existing Calibre database.
    image: lscr.io/linuxserver/calibre-web
    container_name: calibre-web
    environment:
      - PUID=0
      - PGID=0
      - TZ=Europe/London
      - DOCKER_MODS=linuxserver/calibre-web:calibre #optional
      - OAUTHLIB_RELAX_TOKEN_SCOPE=1 #optional
    volumes:
      - /var/data/calibreweb/config:/config
      - /mnt/ebooks:/books
    ports:
      - 8083:8083
    restart: unless-stopped
    labels:
      - traefik.enable=true
      - traefik.http.services.calibreweb-https.loadbalancer.server.port=8083
      - traefik.http.routers.calibreweb-https.entrypoints=https
      - traefik.http.routers.calibreweb-https.rule=Host(`${CALIBREWEB_SUB?CALIBREWEB_SUB Variable not set}.${DOMAIN?DOMAIN Variable not set}`)
      - traefik.http.routers.calibreweb-https.tls=true
      - traefik.http.routers.calibreweb-https.tls.certresolver=myresolver
      - traefik.http.routers.calibre-web-https.middlewares=authelia@docker
    networks:
      - t2_proxy
  cops:
#COPS links to your Calibre library database and allows downloading and emailing of books directly from a web browser and provides a OPDS feed to connect to your devices.
    image: lscr.io/linuxserver/cops
    container_name: cops
    environment:
      - PUID=0
      - PGID=0
      - TZ=Europe/London
    volumes:
      - /var/data/cops/config:/config
      - /mnt/ebooks:/books
    restart: unless-stopped
    labels:
      - traefik.enable=true
      - traefik.http.services.cops-https.loadbalancer.server.port=80
      - traefik.http.routers.cops-https.entrypoints=https
      - traefik.http.routers.cops-https.rule=Host(`${COPS_SUB?COPS_SUB Variable not set}.${DOMAIN?DOMAIN Variable not set}`)
      - traefik.http.routers.cops-https.tls=true
      - traefik.http.routers.cops-https.tls.certresolver=myresolver
      - traefik.http.routers.cops-https.middlewares=authelia@docker
    networks:
      - t2_proxy
  komga:
#Komga is a free and open source comics/mangas server. Chat on Discord. Features. Browse libraries, series and books via a responsive web UI 
    image: gotson/komga
    container_name: komga
    volumes:
      - /var/data/komga/config:/config
      - /mnt/manga:/data/manga
      - /mnt/comics:/data/comics
      - /etc/timezone:/etc/timezone:ro
    restart: unless-stopped
    labels:
      - traefik.enable=true
      - traefik.http.services.komga-https.loadbalancer.server.port=8080
      - traefik.http.routers.komga-https.entrypoints=https
      - traefik.http.routers.komga-https.rule=Host(`${KOMGA_SUB?KOMGA_SUB Variable not set}.${DOMAIN?DOMAIN Variable not set}`)
      - traefik.http.routers.komga-https.tls=true
      - traefik.http.routers.komga-https.tls.certresolver=myresolver
      - traefik.http.routers.komga-https.middlewares=authelia@docker
    networks:
      - t2_proxy
  lazylibrarian:
#LazyLibrarian is a program to follow authors and grab metadata for all your digital reading needs. 
    image: lscr.io/linuxserver/lazylibrarian
    container_name: lazylibrarian
    environment:
      - PUID=0
      - PGID=0
      - TZ=Europe/London
      - DOCKER_MODS=linuxserver/calibre-web:calibre|linuxserver/mods:lazylibrarian-ffmpeg #optional
    volumes:
      - /var/data/lazylibrarian/config:/config
      - /mnt/downloads:/downloads
      - /mnt/books:/books
      - /mnt/audiobooks:/audiobooks
    restart: unless-stopped
    labels:
      - traefik.enable=true
      - traefik.http.services.lazylibrarian-https.loadbalancer.server.port=5299
      - traefik.http.routers.lazylibrarian-https.entrypoints=https
      - traefik.http.routers.lazylibrarian-https.rule=Host(`${LAZYLIBRARIAN_SUB?LAZYLIBRARIAN_SUB Variable not set}.${DOMAIN?DOMAIN Variable not set}`)
      - traefik.http.routers.lazylibrarian-https.tls=true
      - traefik.http.routers.lazylibrarian-https.tls.certresolver=myresolver
      - traefik.http.routers.lazylibrarian-https.middlewares=authelia@docker
    networks:
      - t2_proxy
  ubooquity:
#Ubooquity is a free home server for your comics and ebooks library Â· Read your ebooks and comics on your favorite device, wherever you go 
    image: lscr.io/linuxserver/ubooquity
    container_name: ubooquity
    environment:
      - PUID=0
      - PGID=0
      - TZ=Europe/London
    volumes:
      - /var/data/ubooquity/config:/config
      - /mnt/ebooks:/books
      - /mnt/comics:/comics
      - /mnt/raw:/files
    restart: unless-stopped
    labels:
      - traefik.enable=true
      - traefik.http.services.ubooquity-https.loadbalancer.server.port=2202
      - traefik.http.routers.ubooquity-https.entrypoints=https
      - traefik.http.routers.ubooquity-https.rule=Host(`${UBOOQUITY_SUB?UBOOQUITY_SUB Variable not set}.${DOMAIN?DOMAIN Variable not set}`)
      - traefik.http.routers.ubooquity-https.tls=true
      - traefik.http.routers.ubooquity-https.tls.certresolver=myresolver
      - traefik.http.routers.ubooquity-https.middlewares=authelia@docker
      - traefik.http.services.ubooquity-admin-https.loadbalancer.server.port=2203
      - traefik.http.routers.ubooquity-admin-https.entrypoints=https
      - traefik.http.routers.ubooquity-admin-https.rule=Host(`${UBOOQUITY_ADMIN_SUB?UBOOQUITY_ADMIN_SUB Variable not set}.${DOMAIN?DOMAIN Variable not set}`)
      - traefik.http.routers.ubooquity-admin-https.tls=true
      - traefik.http.routers.ubooquity-admin-https.tls.certresolver=myresolver
      - traefik.http.routers.ubooquity-admin-https.middlewares=authelia@docker
    networks:
      - t2_proxy